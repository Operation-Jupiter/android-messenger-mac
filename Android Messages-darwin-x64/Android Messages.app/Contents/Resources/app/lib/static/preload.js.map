{"version":3,"sources":["preload.js"],"names":["INJECT_JS_PATH","path","join","__dirname","log","require","setNotificationCallback","callback","OldNotify","window","Notification","newNotify","title","opt","requestPermission","bind","Object","defineProperty","get","permission","injectScripts","needToInject","fs","existsSync","ipcRenderer","send","document","addEventListener","on","event","message","appArgs","JSON","parse","info"],"mappings":";;AAGA;;AACA;;;;AACA;;;;;;AAEA,IAAMA,iBAAiBC,eAAKC,IAAL,CAAUC,SAAV,EAAqB,QAArB,EAA+B,kBAA/B,CAAvB,C,CAPA;;;;AAQA,IAAMC,MAAMC,QAAQ,UAAR,CAAZ;AACA;;;;AAIA,SAASC,uBAAT,CAAiCC,QAAjC,EAA2C;AACzC,MAAMC,YAAYC,OAAOC,YAAzB;AACA,MAAMC,YAAY,SAAZA,SAAY,CAACC,KAAD,EAAQC,GAAR,EAAgB;AAChCN,aAASK,KAAT,EAAgBC,GAAhB;AACA,WAAO,IAAIL,SAAJ,CAAcI,KAAd,EAAqBC,GAArB,CAAP;AACD,GAHD;AAIAF,YAAUG,iBAAV,GAA8BN,UAAUM,iBAAV,CAA4BC,IAA5B,CAAiCP,SAAjC,CAA9B;AACAQ,SAAOC,cAAP,CAAsBN,SAAtB,EAAiC,YAAjC,EAA+C;AAC7CO,SAAK;AAAA,aAAMV,UAAUW,UAAhB;AAAA;AADwC,GAA/C;;AAIAV,SAAOC,YAAP,GAAsBC,SAAtB;AACD;;AAED,SAASS,aAAT,GAAyB;AACvB,MAAMC,eAAeC,aAAGC,UAAH,CAAcvB,cAAd,CAArB;AACA,MAAI,CAACqB,YAAL,EAAmB;AACjB;AACD;AACD;AACA;AACAhB,UAAQL,cAAR;AACD;;AAEDM,wBAAwB,UAACM,KAAD,EAAQC,GAAR,EAAgB;AACtCW,wBAAYC,IAAZ,CAAiB,cAAjB,EAAiCb,KAAjC,EAAwCC,GAAxC;AACD,CAFD;;AAIAa,SAASC,gBAAT,CAA0B,kBAA1B,EAA8C,YAAM;AAClDP;AACD,CAFD;;AAIAI,sBAAYI,EAAZ,CAAe,QAAf,EAAyB,UAACC,KAAD,EAAQC,OAAR,EAAoB;AAC3C,MAAMC,UAAUC,KAAKC,KAAL,CAAWH,OAAX,CAAhB;AACA1B,MAAI8B,IAAJ,CAAS,iBAAT,EAA4BH,OAA5B;AACD,CAHD;;AAKAP,sBAAYI,EAAZ,CAAe,OAAf,EAAwB,UAACC,KAAD,EAAQC,OAAR,EAAoB;AAC1C;AACA1B,MAAI8B,IAAJ,CAAS,QAAT,EAAmBJ,OAAnB;AACD,CAHD","file":"preload.js","sourcesContent":["/**\n Preload file that will be executed in the renderer process\n */\nimport { ipcRenderer } from 'electron';\nimport path from 'path';\nimport fs from 'fs';\n\nconst INJECT_JS_PATH = path.join(__dirname, '../../', 'inject/inject.js');\nconst log = require('loglevel');\n/**\n * Patches window.Notification to set a callback on a new Notification\n * @param callback\n */\nfunction setNotificationCallback(callback) {\n  const OldNotify = window.Notification;\n  const newNotify = (title, opt) => {\n    callback(title, opt);\n    return new OldNotify(title, opt);\n  };\n  newNotify.requestPermission = OldNotify.requestPermission.bind(OldNotify);\n  Object.defineProperty(newNotify, 'permission', {\n    get: () => OldNotify.permission,\n  });\n\n  window.Notification = newNotify;\n}\n\nfunction injectScripts() {\n  const needToInject = fs.existsSync(INJECT_JS_PATH);\n  if (!needToInject) {\n    return;\n  }\n  // Dynamically require scripts\n  // eslint-disable-next-line global-require, import/no-dynamic-require\n  require(INJECT_JS_PATH);\n}\n\nsetNotificationCallback((title, opt) => {\n  ipcRenderer.send('notification', title, opt);\n});\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  injectScripts();\n});\n\nipcRenderer.on('params', (event, message) => {\n  const appArgs = JSON.parse(message);\n  log.info('nativefier.json', appArgs);\n});\n\nipcRenderer.on('debug', (event, message) => {\n  // eslint-disable-next-line no-console\n  log.info('debug:', message);\n});\n"]}